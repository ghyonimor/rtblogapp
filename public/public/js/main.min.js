/*! Packages 22-02-2015 */

"use strict";!function(){var a=angular.module("BlogApp",["ngRoute"]);a.config(["$routeProvider",function(a){a.when("/",{redirectTo:"/posts"}).when("/posts/:param?",{templateUrl:"posts.html",controller:"PostsCtrl"}).when("/post/:param?",{templateUrl:"post.html",controller:"PostCtrl"}).when("/admin",{templateUrl:"admin.html",controller:"AdminCtrl"}).when("/admin/new/post",{templateUrl:"new.html",controller:"NewCtrl"}).when("/admin/edit/post/:param",{templateUrl:"new.html",controller:"EditCtrl"})}])}();var app=angular.module("BlogApp");app.controller("NavCtrl",["$scope","navService","activeService",function(a,b,c){var d=b.navElms;d.then(function(b){a.data=b.data}),a.activate=function(a){return a===c.data?"active":""}}]);var app=angular.module("BlogApp");app.controller("SearchCtrl",["$scope","$location","sanitizeService","activeService",function(a,b,c,d){a.sanitize=c.getUrl,a.check=function(){a.query?(0===d.data||null===d.data?b.path("posts"):1===d.data&&b.path("admin"),b.search("search="+a.sanitize(a.query))):b.search("")},a.query=b.search().search}]);var app=angular.module("BlogApp");app.controller("PostsCtrl",["$scope","$filter","$location","$route","$routeParams","postsService","activeService","sanitizeService",function(a,b,c,d,e,f,g,h){var i=f.getPosts;i.then(function(c){a.data=c.data,a.currentPage=e.param?Number(e.param):1,a.hasOlder=function(){return b("filterPosts")(a.data.posts,a.currentPage+1)[0]?!0:!1},a.hasNewer=function(){return b("filterPosts")(a.data.posts,a.currentPage-1)[0]?!0:!1},a.x=b("filterPosts")(a.data.posts,"count").length}),a.sanitize=h.getUrl,g.data=0,a.currentFilter=c.url().split("?")[1]?"?"+c.url().split("?")[1]:"",a.$watch(function(){return c.url().split("?")[1]},function(a,b){c.url&&a!==b&&"posts"===c.url().split("/")[1]&&c.path("posts/1")},!0),a.$on("$destroy",function(){g.data=null})}]);var app=angular.module("BlogApp");app.controller("PostCtrl",["$scope","$routeParams","postsService","sanitizeService",function(a,b,c,d){var e=c.getPosts;a.url=b.param,a.sanitize=d.getUrl,e.then(function(b){a.data=b.data;for(var c=0;c<a.data.posts.length;c++)a.url===a.sanitize(a.data.posts[c].title)&&(a.single=a.data.posts[c])})}]);var app=angular.module("BlogApp");app.controller("AdminCtrl",["$scope","$location","sanitizeService","activeService","postsService",function(a,b,c,d,e){d.data=1;var f=e.getPosts;a.sanitize=c.getUrl,f.then(function(b){a.data=b.data}),a.$on("$destroy",function(){d.data=null}),a.check=function(c){var d=a.sanitize(c.title);b.url("admin/edit/post/"+d)},a.predicate="title",a.reverse=!1,a.$watch("predicate",function(){a.reverse=!1})}]);var app=angular.module("BlogApp");app.factory("postsService",["$http",function(a){var b=a.get("posts");return{getPosts:b}}]);var app=angular.module("BlogApp");app.factory("navService",["$http",function(a){var b=a.get("data/nav.json");return{navElms:b}}]);var app=angular.module("BlogApp");app.factory("activeService",function(){return{data:null}});var app=angular.module("BlogApp");app.factory("sanitizeService",function(){var a=function(a){return a=a.replace(/[$+,:;=@#|'"<>.^*()%!/\s]/g,"").toLowerCase()};return{getUrl:a}});var app=angular.module("BlogApp");app.controller("FiltersCtrl",["$scope","$location","$filter","$route","postsService","sanitizeService","activeService",function(a,b,c,d,e,f,g){var h=e.getPosts;h.then(function(e){a.data=e.data,a.categories={},1===g.data||null===a.route?a.route="admin":0===g.data&&(a.route="posts"),a.authors={},a.years={},a.numPosts=a.data.posts.length,a.keyUp=function(a){return Object.keys(a)},a.sanitize=f.getUrl,a.$on("$routeChangeSuccess",function(){var b=d.current.params.param,c=d.current.$$route.controller;a.param=b&&"PostsCtrl"===c?"/"+b:""});for(var h=0;h<a.data.posts.length;h++){for(var i=a.data.posts[h],j=i.author,k=i.date,l=c("date")(k,"yyyy"),m=c("date")(k,"MMMM"),n=0;n<i.tags.length;n++){var o=i.tags[n];a.categories[o]=a.categories[o]?a.categories[o]+1:1}a.authors[j]=a.authors[j]?a.authors[j]+1:1,a.years[l]?a.years[l][m]=a.years[l][m]?a.years[l][m]+1:1:(a.years[l]={},a.years[l][m]=1)}a.isActive=function(a){var c=b.url().split("?")[1]?b.url().split("?")[1]:void 0;return-1===b.path().indexOf("/post/")&&c===a?"active":void 0}})}]);var app=angular.module("BlogApp");app.filter("filterPosts",["$location","$filter","sanitizeService",function(a,b,c){return function(d,e){var f,g,h=[],i=a.url().split("?")[1]?a.url().split("?")[1]:"",j=c.getUrl;if(i){f=i.split("=")[0],g=i.split("=")[1];for(var k=0;d&&k<d.length;k++){var l=d[k],m=l.tags,n=j(l.author),o=l.date,p=j(b("date")(o,"MMMM")),q=j(b("date")(o,"yyyy")),r=p+q;if("category"===f)for(var s=0;s<m.length;s++){var t=j(m[s]);t===g&&h.push(l)}else if("author"===f)n===g&&h.push(l);else if("date"===f)r===g&&h.push(l);else if("search"===f)if(j(l.title).indexOf(g)>-1||n.indexOf(g)>-1||j(l.description).indexOf(g)>-1)h.push(l);else for(var u=0;u<m.length;u++)j(m[u]).indexOf(g)>-1&&h.push(l)}}else h=d;return"admin"!==e&&"count"!==e&&(h=h.slice(3*e-3,3*e)),h}}]);var app=angular.module("BlogApp");app.controller("NewCtrl",["$scope","activeService","saveService",function(a,b,c){b.data=1,a.isEditMode=function(){return!1},a.save=c.save,a.type="new",a.index=null}]);var app=angular.module("BlogApp");app.controller("EditCtrl",["$scope","$http","$routeParams","postsService","sanitizeService","activeService","saveService",function(a,b,c,d,e,f,g){var h=c.param,i=e.getUrl,j=d.getPosts;a.type="edit",a.isEditMode=function(){return!0},a.save=g.save,a.del=g.del,f.data=1,j.then(function(c){a.data=c.data,a.posts=a.data.posts;for(var d=0;d<a.posts.length;d++){var e=a.posts[d];i(e.title)===h&&(a.index=d,a.title=e.title,a.author=e.author,a.tags=e.tags,a.description=e.description,b.get(e.mdPath).success(function(b){a.markdown=b}))}})}]);var app=angular.module("BlogApp");app.factory("saveService",["$http",function(a){return{save:function(b,c,d,e,f,g,h){var i;i=f.constructor===Array?f:f.indexOf(",")>-1?f.replace(" ","").split(","):[f];var j={title:d,author:e,tags:i,description:g,mdPath:h};a.post("/posts",{post:j,type:b,index:c})},del:function(b,c){b.preventDefault(),a.post("/posts",{index:c,type:"delete"})}}}]);var app=angular.module("BlogApp");app.directive("markdown",["$window",function(a){return{restrict:"E",link:function(b,c){b.$watch(function(){return b.markdown},function(){var d="";b.markdown&&(d=a.marked(b.markdown)),c.html(d)})}}}]);
//# sourceMappingURL=main.min.js.map