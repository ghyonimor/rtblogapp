/*! Packages 08-02-2015 */

"use strict";!function(){var a=angular.module("BlogApp",["ngRoute","angular-toArrayFilter"]);a.config(["$routeProvider",function(a){a.when("/",{redirectTo:"/posts"}).when("/posts/:param?",{templateUrl:"posts.html",controller:"PostsCtrl"}).when("/post/:param?",{templateUrl:"post.html",controller:"PostCtrl"}).when("/admin/:param?",{templateUrl:"admin.html",controller:"AdminCtrl"})}])}();var app=angular.module("BlogApp");app.controller("NavCtrl",["$scope","navService","activeService",function(a,b,c){var d=b.navElms;d.then(function(b){a.data=b.data}),a.activate=function(a){return a===c.data?"active":""}}]);var app=angular.module("BlogApp");app.controller("SearchCtrl",["$scope","$location",function(a,b){a.check=function(){b.path("posts"),b.search("Search="+a.formCtrl.searchText)}}]);var app=angular.module("BlogApp");app.controller("PostsCtrl",["$scope","$filter","$location","$route","$routeParams","postsService","activeService","sanitizeService",function(a,b,c,d,e,f,g,h){var i=f.getPosts;a.pages=[],i.then(function(c){a.data=c.data;var d=a.data.posts.length;if(3>d&&console.log("do nothing"),d>3)for(var f=Math.ceil(d/3),g=1;f+1>g;g++){a.pages[g]=[];for(var h=3*g-3;3*g>h;h++)a.data.posts[h]&&a.pages[g].push(a.data.posts[h])}a.pages=b("filterPosts")(a.pages),e.param?a.currentPage=Number(e.param):(a.currentPage=1,d>3&&console.log("change route param")),a.pages[a.currentPage-1]||$(".next").css("display","none"),a.pages[a.currentPage+1]||$(".previous").css("display","none")}),a.sanitize=h.getUrl,g.data=0,a.currentFilter=c.url().split("?")[1]?"?"+c.url().split("?")[1]:"",a.$watch(function(){return c.url().split("?")[1]},function(a,b){c.url&&a!==b&&"posts"===c.url().split("/")[1]&&(c.path("posts/1"),console.log(c.url().split("/")[1]))},!0),a.$on("$destroy",function(){g.data=null})}]);var app=angular.module("BlogApp");app.controller("PostCtrl",["$scope","$routeParams","postsService","sanitizeService",function(a,b,c,d){var e=c.getPosts;a.url=b.param,a.sanitize=d.getUrl,e.then(function(b){a.data=b.data;for(var c=0;c<a.data.posts.length;c++)a.url===a.sanitize(a.data.posts[c].titles)&&(a.single=a.data.posts[c])})}]);var app=angular.module("BlogApp");app.controller("AdminCtrl",["$scope","activeService",function(a,b){b.data=1,a.$on("$destroy",function(){b.data=null})}]);var app=angular.module("BlogApp");app.factory("postsService",["$http",function(a){var b=a.get("data/posts.json");return{getPosts:b}}]);var app=angular.module("BlogApp");app.factory("navService",["$http",function(a){var b=a.get("data/nav.json");return{navElms:b}}]);var app=angular.module("BlogApp");app.factory("activeService",function(){return{data:null}});var app=angular.module("BlogApp");app.factory("sanitizeService",function(){var a=function(a){return a=a.replace(/[$+,:;=@#|'"<>.^*()%!/\s]/g,"")};return{getUrl:a}});var app=angular.module("BlogApp");app.controller("FiltersCtrl",["$scope","$location","$filter","$route","postsService","sanitizeService",function(a,b,c,d,e,f){var g=e.getPosts;g.then(function(e){a.data=e.data,a.categories={},a.authors={},a.years={},a.numPosts=a.data.posts.length,a.keyUp=function(a){return Object.keys(a)},a.sanitize=f.getUrl,a.addFilter=function(a){return a},a.$on("$routeChangeSuccess",function(){var b=d.current.params.param,c=d.current.$$route.controller;a.param=b&&"PostsCtrl"===c?"/"+b:""});for(var g=0;g<a.data.posts.length;g++){for(var h=a.data.posts[g],i=h.author,j=h.date,k=c("date")(j,"yyyy"),l=c("date")(j,"MMMM"),m=0;m<h.tags.length;m++){var n=h.tags[m];a.categories[n]=a.categories[n]?a.categories[n]+1:1}a.authors[i]=a.authors[i]?a.authors[i]+1:1,a.years[k]?a.years[k][l]=a.years[k][l]?a.years[k][l]+1:1:(a.years[k]={},a.years[k][l]=1)}a.activateFilter=function(){var a=b.url().split("?")[1]?b.url().split("?")[1]:void 0;if(a){var c=$("aside a");$.each(c,function(b,c){var d=$(c),e=c.href.split("?")[1]?c.href.split("?")[1]:void 0;e&&(e===a?d.addClass("active"):d.hasClass("active")&&d.removeClass("active"))})}},a.activateFilter(),a.$on("$locationChangeSuccess",a.activateFilter)})}]);var app=angular.module("BlogApp");app.filter("filterPosts",["$location","$filter","sanitizeService",function(a,b,c){return function(d){var e,f,g,h,i,j,k=[],l=[],m=a.search();for(var n in m)m.hasOwnProperty(n)&&(i=n,j=m[n]);if(j)for(var o=0;o<d.length;o++){h=d[o];for(var p in h)if(h.hasOwnProperty(p)){var q=h[p];if(e=q.tags,f=q.author,g=q.date,"Category"===i)for(var r=0;r<e.length;r++)e[r]===j&&l.push(q);else if("Author"===i&&j===c.getUrl(f))l.push(q);else if("Date"===i){var s=b("date")(g,"MMMM"),t=b("date")(g,"yyyy");j===s+t&&l.push(q)}else if("Search"===i)if(q.titles.indexOf(j)>-1||q.author.indexOf(j)>-1||q.description.indexOf(j)>-1)l.push(q);else for(var u=0;u<e.length;u++)e[u].indexOf(j)>-1&&l.push(q)}}else for(var v=0;v<d.length;v++){var w=d[v];for(var x in w)if(w.hasOwnProperty(x)){var y=w[x];l.push(y)}}l.sort(function(a,b){return parseFloat(b.date)-parseFloat(a.date)});for(var z=l.length,A=Math.ceil(z/3),B=1;A+1>B;B++){k[B]=[];for(var C=3*B-3;3*B>C;C++)l[C]&&k[B].push(l[C])}return k}}]);
//# sourceMappingURL=main.min.js.map