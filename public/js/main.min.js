/*! Packages 14-02-2015 */

"use strict";!function(){var a=angular.module("BlogApp",["ngRoute","angular-toArrayFilter"]);a.config(["$routeProvider",function(a){a.when("/",{redirectTo:"/posts"}).when("/posts/:param?",{templateUrl:"posts.html",controller:"PostsCtrl"}).when("/post/:param?",{templateUrl:"post.html",controller:"PostCtrl"}).when("/admin",{templateUrl:"admin.html",controller:"AdminCtrl"}).when("/admin/new/post",{templateUrl:"edit.html",controller:"NewCtrl"}).when("/admin/edit/post/:param",{templateUrl:"edit.html",controller:"EditCtrl"})}])}();var app=angular.module("BlogApp");app.controller("NavCtrl",["$scope","navService","activeService",function(a,b,c){var d=b.navElms;d.then(function(b){a.data=b.data}),a.activate=function(a){return a===c.data?"active":""}}]);var app=angular.module("BlogApp");app.controller("SearchCtrl",["$scope","$location","sanitizeService",function(a,b,c){a.sanitize=c.getUrl,a.check=function(){b.path("posts"),b.search("search="+a.sanitize(a.formCtrl.searchText))}}]);var app=angular.module("BlogApp");app.controller("PostsCtrl",["$scope","$filter","$location","$route","$routeParams","postsService","activeService","sanitizeService",function(a,b,c,d,e,f,g,h){var i=f.getPosts;a.pages=[],i.then(function(c){a.data=c.data;var d=a.data.posts.length;if(d>3)for(var f=Math.ceil(d/3),g=1;f+1>g;g++){a.pages[g]=[];for(var h=3*g-3;3*g>h;h++)a.data.posts[h]&&a.pages[g].push(a.data.posts[h])}a.pages=b("filterPosts")(a.pages),a.x=function(){for(var b=0,c=0;c<a.pages.length;c++){var d=a.pages[c];d&&(console.log(d.length),b+=d.length)}return console.log(b),b}(),a.currentPage=e.param?Number(e.param):1,a.pages[a.currentPage-1]||$(".next").css("display","none"),a.pages[a.currentPage+1]||$(".previous").css("display","none")}),a.sanitize=h.getUrl,g.data=0,a.currentFilter=c.url().split("?")[1]?"?"+c.url().split("?")[1]:"",a.$watch(function(){return c.url().split("?")[1]},function(a,b){c.url&&a!==b&&"posts"===c.url().split("/")[1]&&c.path("posts/1")},!0),a.$on("$destroy",function(){g.data=null})}]);var app=angular.module("BlogApp");app.controller("PostCtrl",["$scope","$routeParams","postsService","sanitizeService",function(a,b,c,d){var e=c.getPosts;a.url=b.param,a.sanitize=d.getUrl,e.then(function(b){a.data=b.data;for(var c=0;c<a.data.posts.length;c++)a.url===a.sanitize(a.data.posts[c].title)&&(a.single=a.data.posts[c])})}]);var app=angular.module("BlogApp");app.controller("AdminCtrl",["$scope","activeService",function(a,b){b.data=1,a.$on("$destroy",function(){b.data=null})}]);var app=angular.module("BlogApp");app.factory("postsService",["$http",function(a){var b=a.get("data/posts.json");return{getPosts:b}}]);var app=angular.module("BlogApp");app.factory("navService",["$http",function(a){var b=a.get("data/nav.json");return{navElms:b}}]);var app=angular.module("BlogApp");app.factory("activeService",function(){return{data:null}});var app=angular.module("BlogApp");app.factory("sanitizeService",function(){var a=function(a){return a=a.replace(/[$+,:;=@#|'"<>.^*()%!/\s]/g,"").toLowerCase()};return{getUrl:a}});var app=angular.module("BlogApp");app.controller("FiltersCtrl",["$scope","$location","$filter","$route","postsService","sanitizeService",function(a,b,c,d,e,f){var g=e.getPosts;g.then(function(e){a.data=e.data,a.categories={},a.authors={},a.years={},a.numPosts=a.data.posts.length,a.keyUp=function(a){return Object.keys(a)},a.sanitize=f.getUrl,a.$on("$routeChangeSuccess",function(){var b=d.current.params.param,c=d.current.$$route.controller;a.param=b&&"PostsCtrl"===c?"/"+b:""});for(var g=0;g<a.data.posts.length;g++){for(var h=a.data.posts[g],i=h.author,j=h.date,k=c("date")(j,"yyyy"),l=c("date")(j,"MMMM"),m=0;m<h.tags.length;m++){var n=h.tags[m];a.categories[n]=a.categories[n]?a.categories[n]+1:1}a.authors[i]=a.authors[i]?a.authors[i]+1:1,a.years[k]?a.years[k][l]=a.years[k][l]?a.years[k][l]+1:1:(a.years[k]={},a.years[k][l]=1)}a.isActive=function(a){var c=b.url().split("?")[1]?b.url().split("?")[1]:void 0;return c===a?"active":void 0}})}]);var app=angular.module("BlogApp");app.filter("filterPosts",["$location","$filter","sanitizeService",function(a,b,c){return function(d){var e,f,g,h,i,j,k=[],l=[],m=c.getUrl,n=a.search();for(var o in n)n.hasOwnProperty(o)&&(i=o,j=n[o]);if(j)for(var p=0;p<d.length;p++){h=d[p];for(var q in h)if(h.hasOwnProperty(q)){var r=h[q];if(e=r.tags,f=r.author,g=r.date,"category"===i)for(var s=0;s<e.length;s++)m(e[s])===j&&l.push(r);else if("author"===i&&j===c.getUrl(f))l.push(r);else if("date"===i){var t=b("date")(g,"MMMM"),u=b("date")(g,"yyyy");j===m(t+u)&&l.push(r)}else if("search"===i)if(m(r.title).indexOf(j)>-1||m(r.author).indexOf(j)>-1||m(r.description).indexOf(j)>-1)l.push(r);else for(var v=0;v<e.length;v++)m(e[v]).indexOf(j)>-1&&l.push(r)}}else for(var w=0;w<d.length;w++){var x=d[w];for(var y in x)if(x.hasOwnProperty(y)){var z=x[y];l.push(z)}}l.sort(function(a,b){return parseFloat(b.date)-parseFloat(a.date)});for(var A=l.length,B=Math.ceil(A/3),C=1;B+1>C;C++){k[C]=[];for(var D=3*C-3;3*C>D;D++)l[D]&&k[C].push(l[D])}return k}}]);
//# sourceMappingURL=main.min.js.map